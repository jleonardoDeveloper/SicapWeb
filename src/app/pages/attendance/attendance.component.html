<div class="attendances">

    <mat-card class="section-card">
        <mat-card-header>
            <mat-card-title>Filtros de busqueda</mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <div fxLayout="row wrap" fxLayout.lt-sm="column" fxLayoutGap="1%" fxLayoutAlign="flex-start">
                <mat-form-field
                    fxFlex="0 1 calc(33.3% - 1%)"
                    fxFlex.lt-md="0 1 calc(50% - 1%)"
                    fxFlex.lt-sm="100%">
                    <input matInput placeholder="Documento de Identidad" [(ngModel)]="filterOptions.cNumeroDocumento">
                    <mat-icon matSuffix>mode_edit</mat-icon>
                </mat-form-field>
                <mat-form-field
                    fxFlex="0 1 calc(33.3% - 1%)"
                    fxFlex.lt-md="0 1 calc(50% - 1%)"
                    fxFlex.lt-sm="100%">
                    <input matInput [matDatepicker]="dtFechaInicio" placeholder="Fecha de Inicio" (dateChange)="onInitialDateChange($event)">
                    <mat-datepicker-toggle matSuffix [for]="dtFechaInicio"></mat-datepicker-toggle>
                    <mat-datepicker #dtFechaInicio></mat-datepicker>
                </mat-form-field>
                <mat-form-field
                    fxFlex="0 1 calc(33.3% - 1%)"
                    fxFlex.lt-md="0 1 calc(50% - 1%)"
                    fxFlex.lt-sm="100%">
                    <input matInput [matDatepicker]="dtFechaFin" placeholder="Fecha de Fin" (dateChange)="onFinalDateChange($event)">
                    <mat-datepicker-toggle matSuffix [for]="dtFechaFin"></mat-datepicker-toggle>
                    <mat-datepicker #dtFechaFin></mat-datepicker>
                </mat-form-field>
    
                <mat-form-field
                    fxFlex="0 1 calc(33.3% - 1%)"
                    fxFlex.lt-md="0 1 calc(50% - 1%)"
                    fxFlex.lt-sm="100%">
                    <input matInput placeholder="Sucursal" aria-label="Sucursal" [matAutocomplete]="auto" [formControl]="areaInputFormControl">
                    <mat-autocomplete (optionSelected)="onAreaSelectedChange($event)" autoActiveFirstOption #auto="matAutocomplete" [displayWith]="_showAreaInForm">
                        <mat-option *ngFor="let area of filteredOptions | async" [value]="area">{{area.vNombreArea}}</mat-option>
                    </mat-autocomplete>
                </mat-form-field>
            </div>
            
        </mat-card-content>
        <mat-card-actions>
            <button mat-button (click)="onClickSearchButton()" color="primary">BUSCAR</button>
        </mat-card-actions>
    </mat-card>

    <mat-card class="section-card mat-elevation-z8" >
        <mat-card-content>
            <div class="spinner-container" 
                *ngIf="attendanceDataSource.loading$ | async" >
                <mat-spinner></mat-spinner>
            </div>
    
            <div class="table-container">
                <mat-table [hidden]="!attendanceDataSource.loading$ | async" [dataSource]="attendanceDataSource" matSort matSortActive="vNombreArea" matSortDirection="asc" matSortDisableClear>
                    <ng-container matColumnDef="vNombreArea">
                        <mat-header-cell *matHeaderCellDef mat-sort-header>√Årea</mat-header-cell>
                        <mat-cell *matCellDef="let attendance">{{attendance.vNombreArea}}</mat-cell>
                    </ng-container>
                    <ng-container matColumnDef="vNombreTrabajador">
                        <mat-header-cell *matHeaderCellDef>Trabajador</mat-header-cell>
                        <mat-cell *matCellDef="let attendance">{{attendance.vNombreTrabajador}}</mat-cell>
                    </ng-container>
                    <ng-container matColumnDef="cNumeroDocumento">
                        <mat-header-cell *matHeaderCellDef>Documento</mat-header-cell>
                        <mat-cell *matCellDef="let attendance">{{attendance.cNumeroDocumento}}</mat-cell>
                    </ng-container>
                    <ng-container matColumnDef="dtFechaMarcacion">
                        <mat-header-cell *matHeaderCellDef>Fecha</mat-header-cell>
                        <mat-cell *matCellDef="let attendance">{{attendance.dtFechaMarcacion}}</mat-cell>
                    </ng-container>
                    <ng-container matColumnDef="tHoraIngreso">
                        <mat-header-cell *matHeaderCellDef>Ingreso</mat-header-cell>
                        <mat-cell *matCellDef="let attendance">{{attendance.tHoraIngreso}}</mat-cell>
                    </ng-container>
                    <ng-container matColumnDef="tHoraSalidaAlmuerzo">
                        <mat-header-cell *matHeaderCellDef>Salida Almuerzo</mat-header-cell>
                        <mat-cell *matCellDef="let attendance">{{attendance.tHoraSalidaAlmuerzo}}</mat-cell>
                    </ng-container>
                    <ng-container matColumnDef="tHoraRetornoAlmuerzo">
                        <mat-header-cell *matHeaderCellDef>Retorno Almuerzo</mat-header-cell>
                        <mat-cell *matCellDef="let attendance">{{attendance.tHoraRetornoAlmuerzo}}</mat-cell>
                    </ng-container>
                    <ng-container matColumnDef="tHoraSalida">
                        <mat-header-cell *matHeaderCellDef>Salida</mat-header-cell>
                        <mat-cell *matCellDef="let attendance">{{attendance.tHoraSalida}}</mat-cell>
                    </ng-container>
                    <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
                    <mat-row *matRowDef="let row; columns: displayedColumns" (click)="onRowClicked(row)"></mat-row>
                </mat-table>
                <mat-paginator [length]="attendanceDataSource.globalResponseParameters.iRecordCount" 
                    [pageSize]="10" 
                    [pageSizeOptions]="[10, 25, 50, 100, 500]" 
                    (page)="onPaginatorChange()"
                    showFirstLastButtons>
                </mat-paginator>
            </div>
        </mat-card-content>
    </mat-card>

</div>
